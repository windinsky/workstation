/*! my-project-name 2016-03-11 */
windinsky.define("images/upload",["jquery"],function(a,b,c){function d(a){function b(a){if(a.lengthComputable){var b=a.total,c=a.loaded,d=100*c/b;e(this).width(d+"%")}}var c=a.target.files,h=c.length;if(h>10)return alert("you can only upload 10 photos once");e("#file").unbind("change");var i=e("#progress").show().find("tbody").empty();e("#masker").show(),e.each(c,function(a,c){var j=e("<tr><td>"+c.name+"</td><td><div><div></div></div></td></tr>").appendTo(i).find("div:last");if(c.size>g)return j.parents("td:first").html("image is too big");var k=new FormData;k.append("upload",c),e.ajax({url:"/image/upload",data:k,type:"POST",dataType:"json",processData:!1,contentType:!1,xhr:function(){var a=e.ajaxSettings.xhr();return a.upload&&a.upload.addEventListener("progress",b.bind(j),!1),a},success:f||function(a){},complete:function(){h--,h||(e("#file").val(""),e("#file").bind("change",d))}})})}var e=a("jquery"),f=function(){};b.setup_upload=function(a,b,c){console.log(b,typeof b),"function"==typeof b&&(c=b),a.change(d),f=c,b.click(function(a){return e("#progress,#masker").fadeOut(),!1})};var g=8388608});