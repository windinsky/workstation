/*! my-project-name 2016-03-11 */
windinsky.define("lib/validate",["jquery","ui/tipsy"],function(a,b,c){var d=a("jquery"),e=function(a,b){a.attr("title",b).tipsy({trigger:"manual",gravity:a.data("tipsy-gravity")||"s",fade:Number(a.data("tipsy-fade"))&&!0}).tipsy("show"),a.data("not-fade")||setTimeout(function(){a.tipsy("hide")},3e3)},f=function(a){a.tipsy("hide")},g=function(a,b){var c=d(this),g=a.error||e,h=(a.success||f,a.reg||c.attr("data-reg")),j=a.max||Number(c.attr("data-max")),k=a.max||Number(c.attr("data-min")),l=a.required||c.attr("data-required"),m=d(c.attr("data-same-as"))||d(a.sameas),n=a.ajax,o=a.ajax&&a.ajax.success||EMPTY_FUNC,p=a.ajax&&a.ajax.error||EMPTY_FUNC,q=a.ajax&&a.ajax.cb||EMPTY_FUNC,r=function(a){var b=c.attr("name"),d={};if(d[b]=a,n&&n.data)for(i in n.data)d[i]=n.data[i];return d},s=c.attr("data-max-error")||a.maxError||"max length error",t=c.attr("data-min-error")||a.minError||"min length error",u=c.attr("data-reg-error")||a.regError||"format error",v=c.attr("data-empty-error")||a.requireError||"this information is required",w=c.attr("data-same-as-error")||a.sameAsError||"this information must be same as the other on",x=d.trim(c.val()),y=g,z=c[0].form?d(c[0].form):null,A=z?function(){var a=d(c[0].form);a.attr("data-validate-registered")&&a.attr("data-submit")&&a.trigger("check_validate")}:EMPTY_FUNC,B=z?function(){var a=d(c[0].form);a.length&&a.attr("data-validate-registered")&&a.attr("data-submit")&&a.trigger("error")}:EMPTY_FUNC,C="";return l&&!x&&(C=v),j&&x.length>j&&(C=s),k&&x.length<k?(C=t,y(c,t)):(h&&!x.match(h)&&(C=u),m.length&&m.val()!=x&&(C=w),C?(z&&z.trigger("error"),y(c,C)):void(n?d.ajax({url:n.url,data:r(x),dataType:n.dataType||"json",type:n.method||"get",success:function(a){o(a)?A():B()},error:function(){p(),B()},complete:function(a){q(a)?A():B()}}):(this.attr("data-valid","1"),A())))};c.exports={config:function(a){for(var b=0;b<a.length;b++){var c=a[b],e=d(c.input),f=c.trigger,h=g.bind(e,c);d(f).each(function(a,b){b.ele.on(b.event,h)}),c.ignoreChange||e.on("change",h),e.on("validate",h).attr("data-validate","1")}},validate:function(a,b){a=d(a).attr("data-validate-registered","1"),a.on("check_validate",function(){var a=d(this);"1"===a.attr("data-submit")&&0===a.find(["data-valid","0"]).length&&(a.trigger("submit",{validated:!0}),a.removeAttr("data-submit"))}),a.on("error",function(){d(this).removeAttr("data-submit")}),a.on("submit",function(a,b){if(b&&b.validated)return!0;var c=d(this);if("1"!=c.attr("data-submit"))return c.attr("data-submit","1").find("[data-validate=1]").attr("data-valid","0").trigger("validate"),!1})}}});